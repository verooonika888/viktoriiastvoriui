<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Стратегічна сесія</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;500;600;800&family=Playfair+Display:ital,wght@0,400;0,500;0,600;1,400&display=swap" rel="stylesheet">
    
    <!-- Intl-Tel-Input CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/intl-tel-input@18.2.1/build/css/intlTelInput.css">

    <!-- Facebook Pixel -->
    <script>
        const PIXEL_ID = 'YOUR_PIXEL_ID'; // <--- ВСТАВИТЬ ID ПИКСЕЛЯ

        !function(f,b,e,v,n,t,s)
        {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
        n.callMethod.apply(n,arguments):n.queue.push(arguments)};
        if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
        n.queue=[];t=b.createElement(e);t.async=!0;
        t.src=v;s=b.getElementsByTagName(e)[0];
        s.parentNode.insertBefore(t,s)}(window, document,'script',
        'https://connect.facebook.net/en_US/fbevents.js');
        
        if(PIXEL_ID !== 'YOUR_PIXEL_ID') {
            fbq('init', PIXEL_ID);
            fbq('track', 'PageView');
        }
    </script>

    <style>
        /* --- VISUAL STYLE SYSTEM --- */
        :root {
            --bg-color: #F5F5F4;
            --text-main: #1C1917;
        }

        body {
            font-family: 'Manrope', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            -webkit-font-smoothing: antialiased;
        }

        .serif { font-family: 'Playfair Display', serif; }

        .text-overlay-shadow { text-shadow: 0 4px 12px rgba(0,0,0,0.6); }
        .cherry-glow { text-shadow: 0 0 15px rgba(255, 255, 255, 0.4), 0 0 30px rgba(159, 18, 57, 0.2); }

        /* Buttons */
        .btn-white {
            background-color: white; color: #1C1917; transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        .btn-white:active { transform: scale(0.98); }

        .btn-dark {
            background-color: #1C1917; color: white; transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        /* Inputs */
        .input-field {
            width: 100%; background-color: white; border: 1px solid #E5E5E5; 
            border-radius: 12px; padding: 16px 18px; font-size: 16px; 
            transition: all 0.3s; appearance: none; color: #1C1917;
        }
        .input-field::placeholder { color: #A8A29E; font-weight: 300; }
        .input-field:focus { outline: none; border-color: #1C1917; }
        
        /* Error State */
        .input-error { border-color: #EF4444 !important; background-color: #FEF2F2; }
        .error-text { color: #EF4444; font-size: 12px; margin-top: 4px; display: none; }
        .length-error { color: #EF4444; font-size: 11px; margin-top: 2px; display: none; }
        
        /* Radio */
        input[type="radio"] {
            appearance: none; background-color: #fff; margin: 0; color: #1C1917;
            width: 1.25em; height: 1.25em; border: 1px solid #D6D3D1; border-radius: 50%;
            display: grid; place-content: center; transition: 0.2s all; flex-shrink: 0;
        }
        input[type="radio"]::before {
            content: ""; width: 0.65em; height: 0.65em; border-radius: 50%;
            transform: scale(0); transition: 120ms transform ease-in-out;
            box-shadow: inset 1em 1em #1C1917;
        }
        input[type="radio"]:checked::before { transform: scale(1); }
        input[type="radio"]:checked { border-color: #1C1917; }

        .form-label {
            display: block; font-size: 14px; text-transform: uppercase;
            letter-spacing: 0.05em; color: #44403C; font-weight: 700;
            margin-left: 4px; margin-bottom: 6px;
        }

        .iti { width: 100%; }
        .iti__country-list { z-index: 60; border-radius: 12px; border: none; }

        /* Modal Styles */
        .modal-overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.7); backdrop-filter: blur(5px);
            z-index: 50; display: flex; align-items: center; justify-content: center;
            opacity: 0; pointer-events: none; transition: opacity 0.3s ease;
        }
        .modal-overlay.open { opacity: 1; pointer-events: auto; }
        
        .modal-content {
            background: #F5F5F4; width: 95%; max-width: 550px; max-height: 90vh;
            overflow-y: auto; border-radius: 20px; padding: 30px;
            transform: translateY(20px); transition: transform 0.3s ease;
            position: relative;
        }
        .modal-overlay.open .modal-content { transform: translateY(0); }

        .loader {
            border: 2px solid #333; border-top: 2px solid #fff; border-radius: 50%;
            width: 20px; height: 20px; animation: spin 1s linear infinite; display: inline-block;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="overflow-x-hidden bg-[#F5F5F4]">

    <!-- HERO SECTION -->
    <section class="relative h-[100dvh] w-full overflow-hidden">
        
        <!-- DATE BADGE -->
        <div class="absolute top-8 left-6 z-20">
            <div class="inline-flex items-center gap-3 border border-white/30 bg-white/5 backdrop-blur-md px-5 py-3">
                <span class="text-white text-sm md:text-lg font-medium tracking-wide uppercase">21 лютого</span>
                <span class="w-px h-4 bg-white/40"></span>
                <span class="text-white text-sm md:text-lg font-bold tracking-widest">ONLINE</span>
            </div>
        </div>

        <!-- PHOTO -->
        <img src="n2.JPG" alt="Expert" class="absolute inset-0 w-full h-full object-cover object-center">
        <div class="absolute inset-0 bg-gradient-to-t from-black/90 via-black/30 to-transparent pointer-events-none"></div>

        <!-- CONTENT -->
        <div class="absolute bottom-6 left-6 right-6 md:left-1/2 md:-translate-x-1/2 md:max-w-3xl z-10 text-center">
            <div class="mb-4">
                <h1 class="serif leading-tight tracking-tight">
                    <span class="block text-[28px] md:text-5xl font-medium text-white text-overlay-shadow">
                        <span class="text-[#E7E5E4] font-bold mr-2">БЕЗКОШТОВНИЙ</span> Груповий розбір
                    </span>
                    <span class="block text-[28px] md:text-5xl italic font-normal text-[#9F1239] cherry-glow">
                        контенту та візуалу
                    </span>
                </h1>
                <p class="font-sans text-[13px] md:text-lg text-white/90 font-light mt-2 leading-relaxed max-w-sm mx-auto text-overlay-shadow">
                    після якого твій профіль нарешті говорить про тебе, виглядає професійно і продає
                </p>
            </div>

            <p class="text-white/70 mb-3 font-light text-xs md:text-sm tracking-wider uppercase">
                Щоб прийняти участь, зареєструйся
            </p>

            <!-- TRIGGER BUTTON -->
            <button onclick="openModal()" class="btn-white w-full max-w-xs px-6 py-4 rounded-xl text-base font-semibold tracking-wide shadow-2xl mb-2 cursor-pointer">
                ЗАРЕЄСТРУЙСЯ
            </button>
        </div>
    </section>

    <!-- MODAL FORM -->
    <div id="modal" class="modal-overlay">
        <div class="modal-content">
            <!-- Close Button -->
            <button onclick="closeModal()" class="absolute top-4 right-4 text-[#78716C] hover:text-[#1C1917] p-2">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
            </button>

            <div class="text-center mb-6">
                <h2 class="text-2xl serif text-[#1C1917]">Анкета учасника</h2>
            </div>

            <form id="mainForm" class="space-y-4">
                
                <!-- 1. Ім'я -->
                <div>
                    <label class="form-label">Твоє ім'я</label>
                    <input type="text" name="imya" id="imya" required minlength="3" class="input-field" placeholder="Ваше ім'я">
                    <p class="error-text" id="name-error">Ім'я не може містити цифри</p>
                    <p class="length-error">Мінімум 3 символи</p>
                </div>

                <!-- 2. Телефон -->
                <div>
                    <label class="form-label">Телефон</label>
                    <input type="tel" id="phone" name="phone" required class="input-field">
                    <p class="error-text" id="phone-error">Некоректний номер</p>
                    <p class="error-text" id="country-error">Реєстрація з цього регіону недоступна</p>
                </div>

                <!-- 3. Ніша -->
                <div>
                    <label class="form-label">Чим ти займаєшся?</label>
                    <input type="text" name="niche" required minlength="3" class="input-field" placeholder="Таргет, Психологія...">
                    <p class="length-error">Мінімум 3 символи</p>
                </div>

                <!-- 4. Мета -->
                <div>
                    <label class="form-label">Яка мета ведення профілю?</label>
                    <input type="text" name="goal" required minlength="3" class="input-field" placeholder="Продажі, блог...">
                    <p class="length-error">Мінімум 3 символи</p>
                </div>

                <!-- 5. Труднощі -->
                <div>
                    <label class="form-label">Які є труднощі?</label>
                    <textarea name="difficulties" required minlength="3" rows="2" class="input-field" placeholder="Опишіть коротко..."></textarea>
                    <p class="length-error">Мінімум 3 символи</p>
                </div>

                <!-- 6. Соцмережі -->
                <div>
                    <label class="form-label">Instagram (@username)</label>
                    <input type="text" name="instagram" required minlength="3" class="input-field" placeholder="@username">
                    <p class="length-error">Мінімум 3 символи</p>
                </div>

                <!-- 7. ТГ Нік -->
                <div>
                    <label class="form-label">Telegram (@username)</label>
                    <input type="text" name="tg_nick" required minlength="3" class="input-field" placeholder="@username">
                    <p class="length-error">Мінімум 3 символи</p>
                </div>

                <!-- 8. Тип участі -->
                <div class="pt-2 space-y-2">
                    <label class="flex items-center gap-3 p-3 border border-[#E5E5E5] rounded-xl bg-white cursor-pointer hover:border-[#1C1917]">
                        <input type="radio" name="participation_type" value="audit" required>
                        <span class="text-[#1C1917] font-medium">Хочу щоб мене розібрали</span>
                    </label>
                    <label class="flex items-center gap-3 p-3 border border-[#E5E5E5] rounded-xl bg-white cursor-pointer hover:border-[#1C1917]">
                        <input type="radio" name="participation_type" value="viewer" required>
                        <span class="text-[#1C1917] font-medium">Хочу бути глядачем</span>
                    </label>
                </div>

                <!-- Submit -->
                <div class="pt-2">
                    <button type="submit" class="w-full btn-dark py-4 rounded-xl font-medium text-lg flex justify-center items-center shadow-lg">
                        <span class="btn-text">ВІДПРАВИТИ</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- SCRIPTS -->
    <script src="https://cdn.jsdelivr.net/npm/intl-tel-input@18.2.1/build/js/intlTelInput.min.js"></script>
    <script defer>
        // --- CONFIGURATION ---
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbz1Uoy5xzTYHglvws2R0Ri9NxwPGvyaOXIBGHK41VLd0GnEtLbulEeL9bQlCYprE1ic/exec'; 
        const TG_BOT_URL = 'https://t.me/YOUR_BOT'; 
        const EXCLUDED_COUNTRIES = ['ru', 'by'];
        // ---------------------

        // Modal Logic
        const modal = document.getElementById('modal');
        function openModal() {
            modal.classList.add('open');
            document.body.style.overflow = 'hidden';
        }
        function closeModal() {
            modal.classList.remove('open');
            document.body.style.overflow = '';
        }

        // Phone Input Init
        const input = document.querySelector("#phone");
        const iti = window.intlTelInput(input, {
            initialCountry: "auto",
            geoIpLookup: callback => {
                fetch("https://get.geojs.io/v1/ip/country.json")
                    .then(res => res.json())
                    .then(data => callback(data.country))
                    .catch(() => callback("ua"));
            },
            utilsScript: "https://cdn.jsdelivr.net/npm/intl-tel-input@18.2.1/build/js/utils.js",
            separateDialCode: true,
            autoPlaceholder: "aggressive"
        });

        // Validation & Submit
        const form = document.getElementById('mainForm');
        
        form.addEventListener('submit', (e) => {
            e.preventDefault();
            
            // Elements
            const nameInput = document.getElementById('imya');
            const nameError = document.getElementById('name-error');
            const phoneError = document.getElementById('phone-error');
            const countryError = document.getElementById('country-error');
            const btn = form.querySelector('button');
            const btnText = form.querySelector('.btn-text');

            // Reset All Errors
            const allInputs = form.querySelectorAll('input, textarea');
            allInputs.forEach(el => el.classList.remove('input-error'));
            document.querySelectorAll('.error-text, .length-error').forEach(el => el.style.display = 'none');

            let isValid = true;

            // 1. Name Validation (No digits)
            const nameRegex = /\d/;
            if (nameRegex.test(nameInput.value)) {
                nameInput.classList.add('input-error');
                nameError.style.display = 'block';
                isValid = false;
            }

            // 2. Length Validation (Min 3 chars)
            const textFields = ['imya', 'niche', 'goal', 'difficulties', 'instagram', 'tg_nick'];
            textFields.forEach(fieldName => {
                const el = form.querySelector(`[name="${fieldName}"]`);
                if (el) {
                    const val = el.value.trim();
                    if (val.length < 3) {
                        el.classList.add('input-error');
                        const errorMsg = el.parentElement.querySelector('.length-error');
                        if (errorMsg) errorMsg.style.display = 'block';
                        isValid = false;
                    }
                }
            });

            // 3. Phone Format Validation
            if (!iti.isValidNumber()) {
                input.classList.add('input-error');
                phoneError.style.display = 'block';
                isValid = false;
            }

            // 4. Country Exclusion
            const countryData = iti.getSelectedCountryData();
            if (EXCLUDED_COUNTRIES.includes(countryData.iso2)) {
                input.classList.add('input-error');
                countryError.style.display = 'block';
                isValid = false;
            }

            if (!isValid) return;

            // Prepare Data
            const originalText = btnText.innerText;
            btnText.innerHTML = '<span class="loader"></span>';
            btn.disabled = true;

            const formData = new FormData(form);
            const data = {
                imya: formData.get('imya'),
                phone: iti.getNumber(),
                niche: formData.get('niche'),
                goal: formData.get('goal'),
                difficulties: formData.get('difficulties'),
                instagram: formData.get('instagram'),
                tg_nick: formData.get('tg_nick'),
                participation_type: formData.get('participation_type'),
                country: countryData.name,
                utm_source: new URLSearchParams(window.location.search).get('utm_source'),
                utm_medium: new URLSearchParams(window.location.search).get('utm_medium'),
                utm_campaign: new URLSearchParams(window.location.search).get('utm_campaign')
            };

            fetch(GOOGLE_SCRIPT_URL, {
                method: 'POST',
                mode: 'no-cors',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            })
            .then(() => {
                if(typeof fbq !== 'undefined') fbq('track', 'Lead');
                window.location.href = TG_BOT_URL;
            })
            .catch(err => {
                console.error(err);
                alert("Сталася помилка. Спробуйте пізніше.");
                btnText.innerText = originalText;
                btn.disabled = false;
            });
        });

        // Close modal on outside click
        modal.addEventListener('click', (e) => {
            if (e.target === modal) closeModal();
        });
    </script>
</body>
</html>
